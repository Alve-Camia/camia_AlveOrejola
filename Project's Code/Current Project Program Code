import tkinter as tk
from tkinter import messagebox
from datetime import datetime


def signup():
    username = username_box.get()
    password = password_box.get()

    if username == "":
        messagebox.showwarning("Error", "Please enter a username.")
        return
    if not username.isalpha():
        messagebox.showwarning("Error", "Username must contain letters only.")
        return

    if len(password) < 8:
        messagebox.showwarning("Error", "Password must be at least 8 characters long.")
        return
    
    with open("users.txt", "a") as f:
        f.write(username + "," + password + "\n")
    
    messagebox.showinfo("Success", "Sign Up Successful!")
    username_box.delete(0, tk.END)
    password_box.delete(0, tk.END)

def login():
    username = username_box.get()
    password = password_box.get()

    if username == "" or password == "":
        messagebox.showwarning("Error", "Please enter username and password.")
        return

    found = False
    try:
        with open("users.txt", "r") as f:
            for line in f:
                user, pw = line.strip().split(",")
                if user == username and pw == password:
                    found = True
                    break
    except FileNotFoundError:
        messagebox.showwarning("Error", "No users signed up yet.")
        return

    if found:
        time = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
        msg_label.config(text=username + " logged IN at " + time)

        with open("attendance.txt", "a") as file:
            file.write(username + " logged IN at " + time + "\n")
    else:
        messagebox.showwarning("Error", "Invalid account name or password. Please try again.")

#GUI

win = tk.Tk()
win.title("Attendance Checker")
win.geometry("500x500")

title = tk.Label(win, text="Attendance Checker", font=("Montserrat", 24))
title.pack(pady=(20,10))

#username
username_label = tk.Label(win, text="Enter Account Name (letters):", font=("Arial", 12))
username_label.pack(pady=(10,3))
username_box = tk.Entry(win, width=30)
username_box.pack(pady=(3,10))

#pass
password_label = tk.Label(win, text="Enter Password (must contain 8 letters or more):", font=("Arial", 12))
password_label.pack(pady=(5,3))
password_box = tk.Entry(win, width=30, show="*")
password_box.pack(pady=(3,10))

#butoons
signup_btn = tk.Button(win, text="Sign Up", width=15, font=("Montserrat", 12), command=signup)
signup_btn.pack(pady=5)

login_btn = tk.Button(win, text="Log In", width=15, font=("Montserrat", 12), command=login)
login_btn.pack(pady=5)

#msg
msg_label = tk.Label(win, text="", fg="green", font=("Arial", 12))
msg_label.pack(pady=10)

win.mainloop()
